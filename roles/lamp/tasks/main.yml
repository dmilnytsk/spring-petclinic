---
  - name: Checking a simple command
    command: "whoami"
        
  - name: install Java
    apt: 
      name: default-jre, default-jdk
      state: present
    become: yes
       
  - name: Creates directory
    file:
      path: /opt/petclinic
      state: directory
    become: yes       

  #- name: Change ownership of folder
  #  ansible.builtin.file:
  #    path: /opt/petclinic
  #    state: directory
  #    recurse: yes
  #    owner: ubuntu
  #    group: ubuntu
  
  - name: Clone a github repository
    git:
      repo: https://github.com/dmilnytsk/spring-petclinic.git
      dest: /opt/petclinic
      clone: yes
      update: yes
      version: petclinic
    become: yes
  
  - name: make mvn wrapper executable
    file: dest=/opt/petclinic/mvnw mode=a+x
    become: yes
    #become_user: ubuntu

  - name: build java application
    command: ./mvnw package
    become: yes
    #become_user: ubuntu
    args:
      chdir: /opt/petclinic

  - name: run java application
    shell: java -jar -Dspring.profiles.active=mysql target/*.jar
    become: yes
    #become_user: ubuntu
    args:
      chdir: /opt/petclinic
